<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test POS Cart Visibility Fix</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        .test-section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
        }
        .success { background: #d1e7dd; color: #0f5132; }
        .error { background: #f8d7da; color: #842029; }
        .warning { background: #fff3cd; color: #664d03; }
        .info { background: #cff4fc; color: #055160; }
        
        .test-result {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-weight: bold;
        }
        
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <h2><i class="bi bi-check-circle me-2"></i>POS Cart Visibility Fix - Test & Verification</h2>
        <p class="text-muted">Verifikasi perbaikan keranjang belanja POS yang tidak muncul</p>

        <div class="test-section success">
            <h5><i class="bi bi-tools me-2"></i>Perbaikan yang Diterapkan</h5>
            <ul>
                <li>‚úÖ CSS override dengan !important untuk memaksa cart muncul</li>
                <li>‚úÖ Fixed width 400px untuk cart column</li>
                <li>‚úÖ Flexbox layout yang lebih robust</li>
                <li>‚úÖ Inline styles untuk backup visibility</li>
                <li>‚úÖ Z-index untuk memastikan cart di atas</li>
            </ul>
        </div>

        <div class="test-section info">
            <h5><i class="bi bi-list-check me-2"></i>Langkah Testing</h5>
            <ol>
                <li><strong>Refresh Browser</strong> - Tekan F5 atau Ctrl+R</li>
                <li><strong>Buka POS</strong> - Login ‚Üí Menu "Point of Sales"</li>
                <li><strong>Verifikasi Layout</strong> - Pastikan ada 2 kolom (produk kiri, cart kanan)</li>
                <li><strong>Test Responsive</strong> - Resize browser window</li>
                <li><strong>Test Functionality</strong> - Add produk ke cart</li>
            </ol>
            
            <div class="mt-3">
                <button class="btn btn-primary" onclick="openPOSTest()">
                    <i class="bi bi-play me-2"></i>Buka POS untuk Test
                </button>
                <button class="btn btn-secondary ms-2" onclick="runDiagnostic()">
                    <i class="bi bi-search me-2"></i>Run Diagnostic
                </button>
            </div>
        </div>

        <div class="test-section warning">
            <h5><i class="bi bi-exclamation-triangle me-2"></i>Yang Harus Terlihat di POS</h5>
            <div class="row">
                <div class="col-md-6">
                    <h6>Sisi Kiri (Products):</h6>
                    <ul>
                        <li>Search bar produk</li>
                        <li>Grid produk dengan card</li>
                        <li>Tombol "Kembali ke Menu"</li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <h6>Sisi Kanan (Cart) - WIDTH 400px:</h6>
                    <ul>
                        <li>Header "Keranjang Belanja"</li>
                        <li>Dropdown "Pilih Anggota"</li>
                        <li>Area cart items</li>
                        <li>Total amount</li>
                        <li>Payment methods (Cash/Kredit)</li>
                        <li>Tombol "Bayar Sekarang"</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h5><i class="bi bi-code-slash me-2"></i>Manual Fix (Jika Masih Bermasalah)</h5>
            <p>Jika cart masih tidak muncul, buka Developer Tools (F12) dan jalankan kode ini:</p>
            
            <div class="code-block">
// EMERGENCY CART FIX
console.log('üîß Applying emergency cart fix...');

const cartColumn = document.querySelector('.cart-column');
const cartSection = document.querySelector('.cart-section');
const mainContent = document.querySelector('.main-content');

if (cartColumn && cartSection && mainContent) {
    // Force main layout
    mainContent.style.display = 'flex';
    mainContent.style.flexDirection = 'row';
    mainContent.style.width = '100%';
    mainContent.style.height = 'calc(100vh - 80px)';
    
    // Force cart visibility
    cartColumn.style.display = 'block';
    cartColumn.style.width = '400px';
    cartColumn.style.minWidth = '400px';
    cartColumn.style.maxWidth = '400px';
    cartColumn.style.flexShrink = '0';
    cartColumn.style.background = 'white';
    cartColumn.style.borderLeft = '3px solid #52b788';
    cartColumn.style.boxShadow = '-2px 0 10px rgba(45, 106, 79, 0.1)';
    cartColumn.style.zIndex = '10';
    
    // Force cart section
    cartSection.style.display = 'flex';
    cartSection.style.flexDirection = 'column';
    cartSection.style.height = '100%';
    cartSection.style.padding = '20px';
    cartSection.style.visibility = 'visible';
    cartSection.style.opacity = '1';
    
    console.log('‚úÖ Cart fix applied successfully!');
    console.log('Cart column width:', cartColumn.offsetWidth);
    console.log('Cart visible:', cartColumn.offsetWidth > 0);
} else {
    console.log('‚ùå Cart elements not found!');
    console.log('cartColumn:', !!cartColumn);
    console.log('cartSection:', !!cartSection);
    console.log('mainContent:', !!mainContent);
}
            </div>
        </div>

        <div class="test-section">
            <h5><i class="bi bi-gear me-2"></i>Diagnostic Results</h5>
            <div id="diagnosticResults">
                <p class="text-muted">Klik "Run Diagnostic" untuk memeriksa status POS</p>
            </div>
        </div>

        <div class="test-section">
            <h5><i class="bi bi-question-circle me-2"></i>Troubleshooting</h5>
            <div class="accordion" id="troubleshootingAccordion">
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#problem1">
                            Cart masih tidak muncul sama sekali
                        </button>
                    </h2>
                    <div id="problem1" class="accordion-collapse collapse" data-bs-parent="#troubleshootingAccordion">
                        <div class="accordion-body">
                            <ol>
                                <li>Hard refresh: Ctrl+Shift+R</li>
                                <li>Clear browser cache</li>
                                <li>Pastikan zoom browser 100% (Ctrl+0)</li>
                                <li>Coba browser lain (Chrome/Firefox)</li>
                                <li>Jalankan manual fix di atas</li>
                            </ol>
                        </div>
                    </div>
                </div>
                
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#problem2">
                            Cart muncul tapi terpotong/tidak lengkap
                        </button>
                    </h2>
                    <div id="problem2" class="accordion-collapse collapse" data-bs-parent="#troubleshootingAccordion">
                        <div class="accordion-body">
                            <ol>
                                <li>Perbesar window browser (minimal 1200px lebar)</li>
                                <li>Check responsive mode di DevTools</li>
                                <li>Pastikan tidak ada CSS conflict</li>
                                <li>Scroll ke kanan jika perlu</li>
                            </ol>
                        </div>
                    </div>
                </div>
                
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#problem3">
                            Layout rusak di mobile/tablet
                        </button>
                    </h2>
                    <div id="problem3" class="accordion-collapse collapse" data-bs-parent="#troubleshootingAccordion">
                        <div class="accordion-body">
                            <p>Di layar kecil (&lt;992px), cart akan stack di bawah produk:</p>
                            <ul>
                                <li>Produk: 60% tinggi layar (atas)</li>
                                <li>Cart: 40% tinggi layar (bawah)</li>
                                <li>Scroll vertical untuk navigasi</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function openPOSTest() {
            // Open main application
            const posWindow = window.open('index.html', '_blank', 'width=1400,height=900');
            
            setTimeout(() => {
                alert('POS Test Window Opened!\n\n' +
                      'Langkah:\n' +
                      '1. Login ke aplikasi\n' +
                      '2. Klik menu "Point of Sales"\n' +
                      '3. Verifikasi cart muncul di kanan\n' +
                      '4. Test add produk ke cart\n\n' +
                      'Jika cart tidak muncul:\n' +
                      '- Tekan F12 ‚Üí Console\n' +
                      '- Copy-paste kode manual fix\n' +
                      '- Atau kembali ke halaman ini untuk troubleshooting');
            }, 1000);
        }

        function runDiagnostic() {
            const resultsDiv = document.getElementById('diagnosticResults');
            
            resultsDiv.innerHTML = `
                <div class="test-result info">
                    <i class="bi bi-hourglass-split me-2"></i>Running diagnostic...
                </div>
            `;

            setTimeout(() => {
                const checks = [
                    { name: 'Browser Support', status: checkBrowserSupport() },
                    { name: 'Viewport Size', status: checkViewportSize() },
                    { name: 'CSS Flexbox Support', status: checkFlexboxSupport() },
                    { name: 'Local Storage', status: checkLocalStorage() },
                    { name: 'Bootstrap CSS', status: checkBootstrap() }
                ];

                let allPassed = true;
                let resultsHTML = '<h6>Diagnostic Results:</h6>';

                checks.forEach(check => {
                    const icon = check.status.passed ? 'check-circle text-success' : 'x-circle text-danger';
                    resultsHTML += `
                        <div class="d-flex align-items-center mb-2">
                            <i class="bi bi-${icon} me-2"></i>
                            <span>${check.name}: ${check.status.message}</span>
                        </div>
                    `;
                    if (!check.status.passed) allPassed = false;
                });

                if (allPassed) {
                    resultsHTML += `
                        <div class="test-result success mt-3">
                            <i class="bi bi-check-circle me-2"></i>
                            Semua check passed! POS cart seharusnya berfungsi normal.
                        </div>
                    `;
                } else {
                    resultsHTML += `
                        <div class="test-result warning mt-3">
                            <i class="bi bi-exclamation-triangle me-2"></i>
                            Ada masalah yang terdeteksi. Lihat troubleshooting di bawah.
                        </div>
                    `;
                }

                resultsDiv.innerHTML = resultsHTML;
            }, 2000);
        }

        function checkBrowserSupport() {
            const isModern = 'fetch' in window && 'Promise' in window && 'localStorage' in window;
            return {
                passed: isModern,
                message: isModern ? 'Modern browser detected' : 'Browser tidak mendukung fitur modern'
            };
        }

        function checkViewportSize() {
            const width = window.innerWidth;
            const height = window.innerHeight;
            const isGood = width >= 1200 && height >= 600;
            return {
                passed: isGood,
                message: `${width}x${height} ${isGood ? '(Good)' : '(Too small - min 1200x600)'}`
            };
        }

        function checkFlexboxSupport() {
            const testDiv = document.createElement('div');
            testDiv.style.display = 'flex';
            const hasFlexbox = testDiv.style.display === 'flex';
            return {
                passed: hasFlexbox,
                message: hasFlexbox ? 'Flexbox supported' : 'Flexbox not supported'
            };
        }

        function checkLocalStorage() {
            try {
                localStorage.setItem('test', 'test');
                localStorage.removeItem('test');
                return { passed: true, message: 'LocalStorage available' };
            } catch (e) {
                return { passed: false, message: 'LocalStorage not available' };
            }
        }

        function checkBootstrap() {
            const hasBootstrap = !!document.querySelector('link[href*="bootstrap"]') || 
                               typeof bootstrap !== 'undefined';
            return {
                passed: hasBootstrap,
                message: hasBootstrap ? 'Bootstrap loaded' : 'Bootstrap not detected'
            };
        }

        // Auto-run diagnostic on page load
        window.addEventListener('load', function() {
            setTimeout(runDiagnostic, 1000);
        });
    </script>
</body>
</html>