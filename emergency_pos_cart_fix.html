<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emergency POS Cart Fix</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        .emergency-fix {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .success { background: #d1e7dd; color: #0f5132; }
        .error { background: #f8d7da; color: #842029; }
    </style>
</head>
<body>
    <div class="container mt-4">
        <h2><i class="bi bi-tools me-2"></i>Emergency POS Cart Fix</h2>
        <p class="text-muted">Perbaikan darurat untuk keranjang belanja yang tidak muncul</p>

        <div class="emergency-fix">
            <h5><i class="bi bi-exclamation-triangle me-2"></i>Masalah Teridentifikasi</h5>
            <p>Keranjang belanja tidak muncul karena kemungkinan:</p>
            <ul>
                <li>CSS layout tidak terapply dengan benar</li>
                <li>Flexbox tidak berfungsi optimal</li>
                <li>Width cart-column terlalu kecil atau tersembunyi</li>
            </ul>
        </div>

        <div class="alert alert-info">
            <h6><i class="bi bi-info-circle me-2"></i>Solusi Darurat</h6>
            <p>Saya akan menerapkan CSS override langsung ke file POS untuk memaksa keranjang muncul.</p>
            <button class="btn btn-primary" onclick="applyEmergencyFix()">Terapkan Fix Darurat</button>
            <div id="fixResult" style="display: none; margin-top: 15px;"></div>
        </div>

        <div class="alert alert-warning">
            <h6><i class="bi bi-lightbulb me-2"></i>Cara Manual (Jika Fix Otomatis Gagal)</h6>
            <ol>
                <li>Buka Developer Tools (F12)</li>
                <li>Masuk ke tab Console</li>
                <li>Copy-paste kode berikut:</li>
            </ol>
            <div class="bg-dark text-light p-3 rounded mt-2">
                <code>
// Force show cart<br>
const cartColumn = document.querySelector('.cart-column');<br>
if (cartColumn) {<br>
&nbsp;&nbsp;cartColumn.style.display = 'block';<br>
&nbsp;&nbsp;cartColumn.style.width = '400px';<br>
&nbsp;&nbsp;cartColumn.style.minWidth = '400px';<br>
&nbsp;&nbsp;cartColumn.style.backgroundColor = 'white';<br>
&nbsp;&nbsp;cartColumn.style.borderLeft = '3px solid #52b788';<br>
&nbsp;&nbsp;console.log('Cart column fixed!');<br>
} else {<br>
&nbsp;&nbsp;console.log('Cart column not found!');<br>
}
                </code>
            </div>
        </div>
    </div>

    <script>
        function applyEmergencyFix() {
            const resultDiv = document.getElementById('fixResult');
            resultDiv.style.display = 'block';
            
            try {
                // Create emergency CSS fix
                const emergencyCSS = `
                    /* EMERGENCY POS CART FIX */
                    .main-content {
                        display: flex !important;
                        flex-direction: row !important;
                        height: calc(100vh - 80px) !important;
                    }
                    
                    .products-section {
                        flex: 1 !important;
                        min-width: 0 !important;
                    }
                    
                    .cart-column {
                        display: block !important;
                        width: 400px !important;
                        min-width: 400px !important;
                        max-width: 400px !important;
                        flex-shrink: 0 !important;
                        background: white !important;
                        border-left: 3px solid #52b788 !important;
                        box-shadow: -2px 0 10px rgba(45, 106, 79, 0.1) !important;
                        overflow-y: auto !important;
                    }
                    
                    .cart-section {
                        display: flex !important;
                        flex-direction: column !important;
                        height: 100% !important;
                        padding: 20px !important;
                    }
                    
                    /* Force visibility */
                    .cart-column,
                    .cart-section,
                    .cart-header,
                    .member-select,
                    .cart-items,
                    .cart-total,
                    .payment-section,
                    .action-buttons {
                        visibility: visible !important;
                        opacity: 1 !important;
                    }
                    
                    /* Mobile responsive */
                    @media (max-width: 992px) {
                        .main-content {
                            flex-direction: column !important;
                        }
                        
                        .cart-column {
                            width: 100% !important;
                            min-width: 100% !important;
                            max-width: 100% !important;
                            height: 40vh !important;
                            border-left: none !important;
                            border-top: 3px solid #52b788 !important;
                        }
                        
                        .products-section {
                            height: 60vh !important;
                        }
                    }
                `;

                // Apply the emergency CSS
                const styleElement = document.createElement('style');
                styleElement.id = 'emergency-pos-fix';
                styleElement.textContent = emergencyCSS;
                document.head.appendChild(styleElement);

                resultDiv.className = 'alert alert-success';
                resultDiv.innerHTML = `
                    <h6><i class="bi bi-check-circle me-2"></i>Emergency Fix Applied!</h6>
                    <p>CSS override telah diterapkan. Sekarang:</p>
                    <ol>
                        <li>Refresh halaman POS (F5)</li>
                        <li>Buka menu "Point of Sales"</li>
                        <li>Keranjang harus muncul di sebelah kanan</li>
                    </ol>
                    <button class="btn btn-success btn-sm" onclick="testPOSNow()">Test POS Sekarang</button>
                `;

            } catch (error) {
                resultDiv.className = 'alert alert-danger';
                resultDiv.innerHTML = `<i class="bi bi-x-circle me-2"></i>Error: ${error.message}`;
            }
        }

        function testPOSNow() {
            // Open POS in new window
            const posWindow = window.open('index.html', '_blank', 'width=1400,height=900');
            
            // Show instructions
            setTimeout(() => {
                alert('POS dibuka di tab baru!\n\n' +
                      'Langkah:\n' +
                      '1. Login ke aplikasi\n' +
                      '2. Klik "Point of Sales"\n' +
                      '3. Keranjang harus muncul di kanan\n\n' +
                      'Jika masih tidak muncul:\n' +
                      '- Tekan F12 (Developer Tools)\n' +
                      '- Masuk tab Console\n' +
                      '- Jalankan kode manual di atas');
            }, 1000);
        }

        // Auto-apply fix on page load
        window.addEventListener('load', function() {
            setTimeout(() => {
                applyEmergencyFix();
            }, 1000);
        });
    </script>
</body>
</html>