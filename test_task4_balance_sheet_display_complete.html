<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task 4 - Balance Sheet Report Display</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .report-header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
        }
        .balance-sheet-container {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            margin-bottom: 2rem;
        }
        .balance-sheet-header {
            text-align: center;
            border-bottom: 3px solid #2c3e50;
            padding-bottom: 1rem;
            margin-bottom: 2rem;
        }
        .balance-sheet-section {
            margin-bottom: 2rem;
        }
        .section-title {
            background-color: #f8f9fa;
            padding: 0.75rem 1rem;
            border-left: 4px solid #2c3e50;
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }
        .account-line {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 1rem;
            border-bottom: 1px solid #eee;
        }
        .account-line:hover {
            background-color: #f8f9fa;
        }
        .account-name {
            font-weight: 500;
        }
        .account-amount {
            font-family: 'Courier New', monospace;
            font-weight: bold;
        }
        .subtotal-line {
            display: flex;
            justify-content: space-between;
            padding: 0.75rem 1rem;
            background-color: #e9ecef;
            border-top: 2px solid #dee2e6;
            border-bottom: 2px solid #dee2e6;
            font-weight: bold;
        }
        .total-line {
            display: flex;
            justify-content: space-between;
            padding: 1rem;
            background-color: #2c3e50;
            color: white;
            font-weight: bold;
            font-size: 1.1rem;
            border-radius: 5px;
            margin-top: 1rem;
        }
        .equation-verification {
            background-color: #d4edda;
            border: 2px solid #28a745;
            border-radius: 10px;
            padding: 1.5rem;
            text-align: center;
            margin-top: 2rem;
        }
        .equation-unbalanced {
            background-color: #f8d7da;
            border-color: #dc3545;
        }
        .period-info {
            background-color: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 1rem;
            margin-bottom: 2rem;
        }
        .control-panel {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        .btn-export {
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
        }
        @media print {
            .control-panel, .report-header {
                display: none !important;
            }
            .balance-sheet-container {
                box-shadow: none;
                border: 1px solid #000;
            }
        }
    </style>
</head>
<body class="bg-light">
    <!-- Header -->
    <div class="report-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1 class="mb-0"><i class="fas fa-chart-line me-3"></i>Task 4 - Balance Sheet Display</h1>
                    <p class="mb-0 mt-2">Implementasi tampilan laporan neraca dengan format standar</p>
                </div>
                <div class="col-md-4 text-end">
                    <button class="btn btn-light" onclick="window.history.back()">
                        <i class="fas fa-arrow-left me-2"></i>Kembali
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Control Panel -->
        <div class="control-panel">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <h5 class="mb-3"><i class="fas fa-cog me-2"></i>Kontrol Laporan</h5>
                    <div class="row">
                        <div class="col-md-6">
                            <label class="form-label">Periode:</label>
                            <select class="form-select" id="periodType" onchange="updatePeriodInputs()">
                                <option value="daily">Harian</option>
                                <option value="monthly">Bulanan</option>
                                <option value="yearly">Tahunan</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Tanggal/Periode:</label>
                            <input type="date" class="form-control" id="reportDate" value="2024-12-31">
                            <select class="form-select d-none" id="reportMonth">
                                <option value="1">Januari</option>
                                <option value="2">Februari</option>
                                <option value="3">Maret</option>
                                <option value="4">April</option>
                                <option value="5">Mei</option>
                                <option value="6">Juni</option>
                                <option value="7">Juli</option>
                                <option value="8">Agustus</option>
                                <option value="9">September</option>
                                <option value="10">Oktober</option>
                                <option value="11">November</option>
                                <option value="12" selected>Desember</option>
                            </select>
                            <select class="form-select d-none" id="reportYear">
                                <option value="2024" selected>2024</option>
                                <option value="2023">2023</option>
                                <option value="2022">2022</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <h5 class="mb-3"><i class="fas fa-download me-2"></i>Export & Print</h5>
                    <button class="btn btn-success btn-export" onclick="generateReport()">
                        <i class="fas fa-sync me-1"></i>Generate Report
                    </button>
                    <button class="btn btn-primary btn-export" onclick="exportToPDF()">
                        <i class="fas fa-file-pdf me-1"></i>Export PDF
                    </button>
                    <button class="btn btn-info btn-export" onclick="exportToExcel()">
                        <i class="fas fa-file-excel me-1"></i>Export Excel
                    </button>
                    <button class="btn btn-secondary btn-export" onclick="printReport()">
                        <i class="fas fa-print me-1"></i>Print
                    </button>
                </div>
            </div>
        </div>

        <!-- Period Information -->
        <div class="period-info">
            <div class="row">
                <div class="col-md-8">
                    <h6 class="mb-1"><i class="fas fa-calendar me-2"></i>Informasi Periode</h6>
                    <div id="periodDisplay">Periode: 31 Desember 2024 (Harian)</div>
                </div>
                <div class="col-md-4 text-end">
                    <small class="text-muted">Generated: <span id="generatedTime"></span></small>
                </div>
            </div>
        </div>

        <!-- Balance Sheet Report -->
        <div class="balance-sheet-container" id="balanceSheetReport">
            <div class="balance-sheet-header">
                <h2 class="mb-1">KOPERASI SIMPAN PINJAM</h2>
                <h3 class="mb-1">NERACA</h3>
                <h4 class="mb-0" id="reportTitle">Per 31 Desember 2024</h4>
            </div>

            <div class="row">
                <!-- ASSETS -->
                <div class="col-md-6">
                    <div class="balance-sheet-section">
                        <div class="section-title">
                            <i class="fas fa-coins me-2"></i>AKTIVA (ASSETS)
                        </div>
                        
                        <!-- Current Assets -->
                        <div class="mb-3">
                            <h6 class="ms-2 mb-2 text-primary">Aktiva Lancar</h6>
                            <div id="currentAssets">
                                <!-- Will be populated by JavaScript -->
                            </div>
                            <div class="subtotal-line">
                                <span>Total Aktiva Lancar</span>
                                <span id="totalCurrentAssets">Rp 0</span>
                            </div>
                        </div>

                        <!-- Fixed Assets -->
                        <div class="mb-3">
                            <h6 class="ms-2 mb-2 text-primary">Aktiva Tetap</h6>
                            <div id="fixedAssets">
                                <!-- Will be populated by JavaScript -->
                            </div>
                            <div class="subtotal-line">
                                <span>Total Aktiva Tetap</span>
                                <span id="totalFixedAssets">Rp 0</span>
                            </div>
                        </div>

                        <div class="total-line">
                            <span>TOTAL AKTIVA</span>
                            <span id="totalAssets">Rp 0</span>
                        </div>
                    </div>
                </div>

                <!-- LIABILITIES & EQUITY -->
                <div class="col-md-6">
                    <div class="balance-sheet-section">
                        <div class="section-title">
                            <i class="fas fa-balance-scale me-2"></i>PASSIVA (LIABILITIES & EQUITY)
                        </div>
                        
                        <!-- Current Liabilities -->
                        <div class="mb-3">
                            <h6 class="ms-2 mb-2 text-danger">Kewajiban Lancar</h6>
                            <div id="currentLiabilities">
                                <!-- Will be populated by JavaScript -->
                            </div>
                            <div class="subtotal-line">
                                <span>Total Kewajiban Lancar</span>
                                <span id="totalCurrentLiabilities">Rp 0</span>
                            </div>
                        </div>

                        <!-- Long-term Liabilities -->
                        <div class="mb-3">
                            <h6 class="ms-2 mb-2 text-danger">Kewajiban Jangka Panjang</h6>
                            <div id="longTermLiabilities">
                                <!-- Will be populated by JavaScript -->
                            </div>
                            <div class="subtotal-line">
                                <span>Total Kewajiban Jangka Panjang</span>
                                <span id="totalLongTermLiabilities">Rp 0</span>
                            </div>
                        </div>

                        <!-- Equity -->
                        <div class="mb-3">
                            <h6 class="ms-2 mb-2 text-success">Modal (Equity)</h6>
                            <div id="equity">
                                <!-- Will be populated by JavaScript -->
                            </div>
                            <div class="subtotal-line">
                                <span>Total Modal</span>
                                <span id="totalEquity">Rp 0</span>
                            </div>
                        </div>

                        <div class="total-line">
                            <span>TOTAL PASSIVA</span>
                            <span id="totalLiabilitiesEquity">Rp 0</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Balance Equation Verification -->
        <div class="equation-verification" id="equationVerification">
            <h5 class="mb-3"><i class="fas fa-equals me-2"></i>Verifikasi Persamaan Neraca</h5>
            <div class="row">
                <div class="col-md-4">
                    <div class="h6">Total Aktiva</div>
                    <div class="h4" id="verifyAssets">Rp 0</div>
                </div>
                <div class="col-md-1 d-flex align-items-center justify-content-center">
                    <div class="h3">=</div>
                </div>
                <div class="col-md-3">
                    <div class="h6">Total Kewajiban</div>
                    <div class="h4" id="verifyLiabilities">Rp 0</div>
                </div>
                <div class="col-md-1 d-flex align-items-center justify-content-center">
                    <div class="h3">+</div>
                </div>
                <div class="col-md-3">
                    <div class="h6">Total Modal</div>
                    <div class="h4" id="verifyEquity">Rp 0</div>
                </div>
            </div>
            <div class="mt-3">
                <div id="balanceStatus" class="h5">
                    <i class="fas fa-check-circle text-success me-2"></i>Neraca Seimbang ✓
                </div>
            </div>
        </div>

        <!-- Test Results -->
        <div class="card mt-4">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0"><i class="fas fa-vial me-2"></i>Test Results - Balance Sheet Display</h5>
            </div>
            <div class="card-body">
                <div id="testResults">
                    <div class="text-muted">Test results akan muncul di sini...</div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Mock Chart of Accounts
        const mockChartOfAccounts = {
            '1-1000': { name: 'Kas', category: 'current_assets', type: 'debit' },
            '1-1100': { name: 'Bank BCA', category: 'current_assets', type: 'debit' },
            '1-1200': { name: 'Piutang Usaha', category: 'current_assets', type: 'debit' },
            '1-1300': { name: 'Persediaan Barang', category: 'current_assets', type: 'debit' },
            '1-1400': { name: 'Piutang Anggota', category: 'current_assets', type: 'debit' },
            '1-2000': { name: 'Peralatan Kantor', category: 'fixed_assets', type: 'debit' },
            '1-2100': { name: 'Akumulasi Penyusutan Peralatan', category: 'fixed_assets', type: 'credit' },
            '1-2200': { name: 'Gedung', category: 'fixed_assets', type: 'debit' },
            '1-2300': { name: 'Akumulasi Penyusutan Gedung', category: 'fixed_assets', type: 'credit' },
            '2-1000': { name: 'Hutang Usaha', category: 'current_liabilities', type: 'credit' },
            '2-1100': { name: 'Hutang Gaji', category: 'current_liabilities', type: 'credit' },
            '2-1200': { name: 'Hutang Pajak', category: 'current_liabilities', type: 'credit' },
            '2-2000': { name: 'Hutang Bank Jangka Panjang', category: 'long_term_liabilities', type: 'credit' },
            '3-1000': { name: 'Modal Saham', category: 'equity', type: 'credit' },
            '3-2000': { name: 'Laba Ditahan', category: 'equity', type: 'credit' },
            '3-3000': { name: 'Laba Tahun Berjalan', category: 'equity', type: 'credit' }
        };

        // Mock balance sheet data
        let currentBalanceSheet = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateGeneratedTime();
            generateReport();
            runDisplayTests();
        });

        function updateGeneratedTime() {
            const now = new Date();
            document.getElementById('generatedTime').textContent = now.toLocaleString('id-ID');
        }

        function updatePeriodInputs() {
            const periodType = document.getElementById('periodType').value;
            const dateInput = document.getElementById('reportDate');
            const monthInput = document.getElementById('reportMonth');
            const yearInput = document.getElementById('reportYear');

            // Hide all inputs first
            dateInput.classList.add('d-none');
            monthInput.classList.add('d-none');
            yearInput.classList.add('d-none');

            // Show appropriate input based on period type
            if (periodType === 'daily') {
                dateInput.classList.remove('d-none');
            } else if (periodType === 'monthly') {
                monthInput.classList.remove('d-none');
                yearInput.classList.remove('d-none');
            } else if (periodType === 'yearly') {
                yearInput.classList.remove('d-none');
            }

            updatePeriodDisplay();
        }

        function updatePeriodDisplay() {
            const periodType = document.getElementById('periodType').value;
            let periodText = '';
            let reportTitle = '';

            if (periodType === 'daily') {
                const date = new Date(document.getElementById('reportDate').value);
                periodText = `Periode: ${date.toLocaleDateString('id-ID')} (Harian)`;
                reportTitle = `Per ${date.toLocaleDateString('id-ID')}`;
            } else if (periodType === 'monthly') {
                const month = document.getElementById('reportMonth').value;
                const year = document.getElementById('reportYear').value;
                const monthNames = ['', 'Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni',
                                  'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'];
                periodText = `Periode: ${monthNames[month]} ${year} (Bulanan)`;
                reportTitle = `Per ${monthNames[month]} ${year}`;
            } else if (periodType === 'yearly') {
                const year = document.getElementById('reportYear').value;
                periodText = `Periode: Tahun ${year} (Tahunan)`;
                reportTitle = `Per 31 Desember ${year}`;
            }

            document.getElementById('periodDisplay').textContent = periodText;
            document.getElementById('reportTitle').textContent = reportTitle;
        }

        function generateReport() {
            updatePeriodDisplay();
            updateGeneratedTime();

            // Generate mock balance sheet data
            const balanceSheet = generateMockBalanceSheet();
            currentBalanceSheet = balanceSheet;

            // Render the balance sheet
            renderBalanceSheet(balanceSheet);

            // Verify equation
            verifyBalanceEquation(balanceSheet);

            logTest('Balance sheet report generated successfully', 'success');
        }

        function generateMockBalanceSheet() {
            // Generate realistic mock data
            const balanceSheet = {
                assets: {
                    current_assets: {
                        '1-1000': { name: 'Kas', balance: 15000000 },
                        '1-1100': { name: 'Bank BCA', balance: 45000000 },
                        '1-1200': { name: 'Piutang Usaha', balance: 12000000 },
                        '1-1300': { name: 'Persediaan Barang', balance: 8000000 },
                        '1-1400': { name: 'Piutang Anggota', balance: 25000000 }
                    },
                    fixed_assets: {
                        '1-2000': { name: 'Peralatan Kantor', balance: 20000000 },
                        '1-2100': { name: 'Akumulasi Penyusutan Peralatan', balance: -5000000 },
                        '1-2200': { name: 'Gedung', balance: 150000000 },
                        '1-2300': { name: 'Akumulasi Penyusutan Gedung', balance: -30000000 }
                    }
                },
                liabilities: {
                    current_liabilities: {
                        '2-1000': { name: 'Hutang Usaha', balance: 8000000 },
                        '2-1100': { name: 'Hutang Gaji', balance: 5000000 },
                        '2-1200': { name: 'Hutang Pajak', balance: 2000000 }
                    },
                    long_term_liabilities: {
                        '2-2000': { name: 'Hutang Bank Jangka Panjang', balance: 50000000 }
                    }
                },
                equity: {
                    '3-1000': { name: 'Modal Saham', balance: 100000000 },
                    '3-2000': { name: 'Laba Ditahan', balance: 45000000 },
                    '3-3000': { name: 'Laba Tahun Berjalan', balance: 30000000 }
                }
            };

            return balanceSheet;
        }

        function renderBalanceSheet(balanceSheet) {
            // Render Current Assets
            renderAccountSection('currentAssets', balanceSheet.assets.current_assets);
            const totalCurrentAssets = calculateSectionTotal(balanceSheet.assets.current_assets);
            document.getElementById('totalCurrentAssets').textContent = formatRupiah(totalCurrentAssets);

            // Render Fixed Assets
            renderAccountSection('fixedAssets', balanceSheet.assets.fixed_assets);
            const totalFixedAssets = calculateSectionTotal(balanceSheet.assets.fixed_assets);
            document.getElementById('totalFixedAssets').textContent = formatRupiah(totalFixedAssets);

            // Total Assets
            const totalAssets = totalCurrentAssets + totalFixedAssets;
            document.getElementById('totalAssets').textContent = formatRupiah(totalAssets);

            // Render Current Liabilities
            renderAccountSection('currentLiabilities', balanceSheet.liabilities.current_liabilities);
            const totalCurrentLiabilities = calculateSectionTotal(balanceSheet.liabilities.current_liabilities);
            document.getElementById('totalCurrentLiabilities').textContent = formatRupiah(totalCurrentLiabilities);

            // Render Long-term Liabilities
            renderAccountSection('longTermLiabilities', balanceSheet.liabilities.long_term_liabilities);
            const totalLongTermLiabilities = calculateSectionTotal(balanceSheet.liabilities.long_term_liabilities);
            document.getElementById('totalLongTermLiabilities').textContent = formatRupiah(totalLongTermLiabilities);

            // Render Equity
            renderAccountSection('equity', balanceSheet.equity);
            const totalEquity = calculateSectionTotal(balanceSheet.equity);
            document.getElementById('totalEquity').textContent = formatRupiah(totalEquity);

            // Total Liabilities & Equity
            const totalLiabilities = totalCurrentLiabilities + totalLongTermLiabilities;
            const totalLiabilitiesEquity = totalLiabilities + totalEquity;
            document.getElementById('totalLiabilitiesEquity').textContent = formatRupiah(totalLiabilitiesEquity);

            // Store totals for verification
            balanceSheet.totals = {
                totalAssets,
                totalLiabilities,
                totalEquity,
                totalLiabilitiesEquity
            };
        }

        function renderAccountSection(containerId, accounts) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';

            Object.keys(accounts).forEach(accountCode => {
                const account = accounts[accountCode];
                const accountLine = document.createElement('div');
                accountLine.className = 'account-line';
                accountLine.innerHTML = `
                    <span class="account-name">${account.name}</span>
                    <span class="account-amount">${formatRupiah(account.balance)}</span>
                `;
                container.appendChild(accountLine);
            });
        }

        function calculateSectionTotal(accounts) {
            let total = 0;
            Object.keys(accounts).forEach(accountCode => {
                total += accounts[accountCode].balance;
            });
            return total;
        }

        function verifyBalanceEquation(balanceSheet) {
            const { totalAssets, totalLiabilities, totalEquity, totalLiabilitiesEquity } = balanceSheet.totals;
            
            // Update verification display
            document.getElementById('verifyAssets').textContent = formatRupiah(totalAssets);
            document.getElementById('verifyLiabilities').textContent = formatRupiah(totalLiabilities);
            document.getElementById('verifyEquity').textContent = formatRupiah(totalEquity);

            // Check if balanced
            const isBalanced = Math.abs(totalAssets - totalLiabilitiesEquity) < 0.01;
            const verificationDiv = document.getElementById('equationVerification');
            const statusDiv = document.getElementById('balanceStatus');

            if (isBalanced) {
                verificationDiv.className = 'equation-verification';
                statusDiv.innerHTML = '<i class="fas fa-check-circle text-success me-2"></i>Neraca Seimbang ✓';
                logTest('Balance equation verified: BALANCED', 'success');
            } else {
                verificationDiv.className = 'equation-verification equation-unbalanced';
                statusDiv.innerHTML = '<i class="fas fa-times-circle text-danger me-2"></i>Neraca Tidak Seimbang ✗';
                logTest('Balance equation verified: UNBALANCED', 'error');
            }
        }

        function formatRupiah(amount) {
            return new Intl.NumberFormat('id-ID', {
                style: 'currency',
                currency: 'IDR',
                minimumFractionDigits: 0
            }).format(amount);
        }

        function exportToPDF() {
            logTest('PDF export functionality called', 'info');
            alert('PDF export akan diimplementasikan dengan library jsPDF');
        }

        function exportToExcel() {
            logTest('Excel export functionality called', 'info');
            alert('Excel export akan diimplementasikan dengan library SheetJS');
        }

        function printReport() {
            logTest('Print functionality called', 'info');
            window.print();
        }

        // Test functions
        function runDisplayTests() {
            logTest('=== Starting Balance Sheet Display Tests ===', 'info');
            
            // Test 1: HTML Template Structure
            testHTMLTemplate();
            
            // Test 2: Report Rendering
            testReportRendering();
            
            // Test 3: Categorization
            testCategorization();
            
            // Test 4: Totals Calculation
            testTotalsCalculation();
            
            // Test 5: Standard Format Compliance
            testFormatCompliance();
            
            logTest('=== Balance Sheet Display Tests Completed ===', 'info');
        }

        function testHTMLTemplate() {
            const requiredElements = [
                'balanceSheetReport', 'currentAssets', 'fixedAssets', 'currentLiabilities',
                'longTermLiabilities', 'equity', 'totalAssets', 'totalLiabilitiesEquity'
            ];
            
            let passed = 0;
            requiredElements.forEach(elementId => {
                if (document.getElementById(elementId)) {
                    passed++;
                } else {
                    logTest(`Missing required element: ${elementId}`, 'error');
                }
            });
            
            if (passed === requiredElements.length) {
                logTest('✅ HTML Template Structure: PASS', 'success');
            } else {
                logTest(`❌ HTML Template Structure: FAIL (${passed}/${requiredElements.length})`, 'error');
            }
        }

        function testReportRendering() {
            if (currentBalanceSheet) {
                const hasCurrentAssets = Object.keys(currentBalanceSheet.assets.current_assets).length > 0;
                const hasFixedAssets = Object.keys(currentBalanceSheet.assets.fixed_assets).length > 0;
                const hasLiabilities = Object.keys(currentBalanceSheet.liabilities.current_liabilities).length > 0;
                const hasEquity = Object.keys(currentBalanceSheet.equity).length > 0;
                
                if (hasCurrentAssets && hasFixedAssets && hasLiabilities && hasEquity) {
                    logTest('✅ Report Rendering: PASS', 'success');
                } else {
                    logTest('❌ Report Rendering: FAIL - Missing sections', 'error');
                }
            } else {
                logTest('❌ Report Rendering: FAIL - No balance sheet data', 'error');
            }
        }

        function testCategorization() {
            const categories = ['current_assets', 'fixed_assets', 'current_liabilities', 'long_term_liabilities', 'equity'];
            let categorizedCorrectly = true;
            
            // Check if all accounts are properly categorized
            Object.keys(mockChartOfAccounts).forEach(accountCode => {
                const account = mockChartOfAccounts[accountCode];
                if (!categories.includes(account.category)) {
                    categorizedCorrectly = false;
                    logTest(`Invalid category for account ${accountCode}: ${account.category}`, 'error');
                }
            });
            
            if (categorizedCorrectly) {
                logTest('✅ Account Categorization: PASS', 'success');
            } else {
                logTest('❌ Account Categorization: FAIL', 'error');
            }
        }

        function testTotalsCalculation() {
            if (currentBalanceSheet && currentBalanceSheet.totals) {
                const { totalAssets, totalLiabilities, totalEquity, totalLiabilitiesEquity } = currentBalanceSheet.totals;
                
                // Test if totals are calculated
                const hasTotals = totalAssets > 0 && totalLiabilitiesEquity > 0;
                
                // Test balance equation
                const isBalanced = Math.abs(totalAssets - totalLiabilitiesEquity) < 0.01;
                
                if (hasTotals && isBalanced) {
                    logTest('✅ Totals Calculation: PASS', 'success');
                } else {
                    logTest('❌ Totals Calculation: FAIL', 'error');
                }
            } else {
                logTest('❌ Totals Calculation: FAIL - No totals data', 'error');
            }
        }

        function testFormatCompliance() {
            // Check standard balance sheet format elements
            const formatElements = [
                document.querySelector('.balance-sheet-header'),
                document.querySelector('.section-title'),
                document.querySelector('.account-line'),
                document.querySelector('.subtotal-line'),
                document.querySelector('.total-line')
            ];
            
            const hasAllElements = formatElements.every(element => element !== null);
            
            if (hasAllElements) {
                logTest('✅ Standard Format Compliance: PASS', 'success');
            } else {
                logTest('❌ Standard Format Compliance: FAIL', 'error');
            }
        }

        function logTest(message, type = 'info') {
            const resultsContainer = document.getElementById('testResults');
            const logEntry = document.createElement('div');
            
            const typeClass = {
                'info': 'text-info',
                'success': 'text-success',
                'error': 'text-danger',
                'warning': 'text-warning'
            };
            
            logEntry.className = `mb-1 ${typeClass[type] || 'text-dark'}`;
            logEntry.innerHTML = `<small>[${new Date().toLocaleTimeString()}] ${message}</small>`;
            
            resultsContainer.appendChild(logEntry);
            resultsContainer.scrollTop = resultsContainer.scrollHeight;
        }

        // Auto-generate report on load
        setTimeout(() => {
            generateReport();
        }, 1000);
    </script>
</body>
</html>