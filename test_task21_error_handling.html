<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task 21: Comprehensive Error Handling Test</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        .test-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            border: 1px solid #dee2e6;
            border-radius: 0.5rem;
        }
        .test-result {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 0.25rem;
        }
        .test-success {
            background-color: #d1e7dd;
            border: 1px solid #badbcc;
            color: #0f5132;
        }
        .test-error {
            background-color: #f8d7da;
            border: 1px solid #f5c2c7;
            color: #842029;
        }
        .test-warning {
            background-color: #fff3cd;
            border: 1px solid #ffecb5;
            color: #664d03;
        }
        .error-log {
            max-height: 300px;
            overflow-y: auto;
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 1rem;
            font-family: monospace;
            font-size: 0.875rem;
        }
    </style>
</head>
<body>
    <div class="container-fluid py-4">
        <div class="row">
            <div class="col-12">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2 style="color: #2d6a4f; font-weight: 700;">
                        <i class="bi bi-shield-exclamation me-2"></i>Task 21: Comprehensive Error Handling Test
                    </h2>
                    <div>
                        <button class="btn btn-primary" onclick="runAllTests()">
                            <i class="bi bi-play-circle me-1"></i>Run All Tests
                        </button>
                        <button class="btn btn-secondary" onclick="clearResults()">
                            <i class="bi bi-arrow-clockwise me-1"></i>Clear Results
                        </button>
                    </div>
                </div>

                <!-- Test Results Summary -->
                <div class="card mb-4">
                    <div class="card-header">
                        <i class="bi bi-clipboard-data me-2"></i>Test Results Summary
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-3">
                                <div class="text-center">
                                    <h4 id="totalTests" class="text-primary">0</h4>
                                    <small>Total Tests</small>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="text-center">
                                    <h4 id="passedTests" class="text-success">0</h4>
                                    <small>Passed</small>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="text-center">
                                    <h4 id="failedTests" class="text-danger">0</h4>
                                    <small>Failed</small>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="text-center">
                                    <h4 id="warningTests" class="text-warning">0</h4>
                                    <small>Warnings</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Error Handler Module Tests -->
                <div class="test-section">
                    <h4><i class="bi bi-gear me-2"></i>Error Handler Module Tests</h4>
                    <p class="text-muted">Testing the comprehensive error handler module functionality</p>
                    
                    <button class="btn btn-outline-primary btn-sm" onclick="testErrorLogging()">
                        Test Error Logging
                    </button>
                    <button class="btn btn-outline-primary btn-sm" onclick="testUserFriendlyMessages()">
                        Test User-Friendly Messages
                    </button>
                    <button class="btn btn-outline-primary btn-sm" onclick="testInputValidation()">
                        Test Input Validation
                    </button>
                    <button class="btn btn-outline-primary btn-sm" onclick="testSafeDataAccess()">
                        Test Safe Data Access
                    </button>
                    
                    <div id="errorHandlerResults"></div>
                </div>

                <!-- Core Function Error Handling Tests -->
                <div class="test-section">
                    <h4><i class="bi bi-funnel me-2"></i>Core Function Error Handling Tests</h4>
                    <p class="text-muted">Testing enhanced error handling in core filtering and validation functions</p>
                    
                    <button class="btn btn-outline-primary btn-sm" onclick="testFilterActiveAnggotaErrors()">
                        Test filterActiveAnggota
                    </button>
                    <button class="btn btn-outline-primary btn-sm" onclick="testFilterTransactableAnggotaErrors()">
                        Test filterTransactableAnggota
                    </button>
                    <button class="btn btn-outline-primary btn-sm" onclick="testValidateAnggotaForTransactionErrors()">
                        Test validateAnggotaForTransaction
                    </button>
                    
                    <div id="coreFunctionResults"></div>
                </div>

                <!-- Simpanan Function Error Handling Tests -->
                <div class="test-section">
                    <h4><i class="bi bi-wallet2 me-2"></i>Simpanan Function Error Handling Tests</h4>
                    <p class="text-muted">Testing enhanced error handling in simpanan-related functions</p>
                    
                    <button class="btn btn-outline-primary btn-sm" onclick="testSaveSimpananPokokErrors()">
                        Test saveSimpananPokok
                    </button>
                    <button class="btn btn-outline-primary btn-sm" onclick="testZeroingSimpananErrors()">
                        Test Zeroing Functions
                    </button>
                    <button class="btn btn-outline-primary btn-sm" onclick="testJournalCreationErrors()">
                        Test Journal Creation
                    </button>
                    
                    <div id="simpananFunctionResults"></div>
                </div>

                <!-- LocalStorage Health Check -->
                <div class="test-section">
                    <h4><i class="bi bi-database me-2"></i>LocalStorage Health Check</h4>
                    <p class="text-muted">Testing localStorage health and recovery mechanisms</p>
                    
                    <button class="btn btn-outline-primary btn-sm" onclick="testLocalStorageHealth()">
                        Check Health
                    </button>
                    <button class="btn btn-outline-warning btn-sm" onclick="simulateCorruptedData()">
                        Simulate Corrupted Data
                    </button>
                    <button class="btn btn-outline-success btn-sm" onclick="testDataRecovery()">
                        Test Recovery
                    </button>
                    
                    <div id="localStorageResults"></div>
                </div>

                <!-- Error Log Viewer -->
                <div class="test-section">
                    <h4><i class="bi bi-journal-text me-2"></i>Error Log Viewer</h4>
                    <p class="text-muted">View and manage error logs</p>
                    
                    <button class="btn btn-outline-info btn-sm" onclick="viewErrorLog()">
                        View Error Log
                    </button>
                    <button class="btn btn-outline-danger btn-sm" onclick="clearErrorLog()">
                        Clear Error Log
                    </button>
                    
                    <div id="errorLogResults">
                        <div class="error-log" id="errorLogDisplay">
                            No error log data available
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/errorHandler.js"></script>
    <script src="js/koperasi.js"></script>
    <script src="js/simpanan.js"></script>
    <script src="js/transactionValidator.js"></script>

    <script>
        // Test tracking
        let testResults = {
            total: 0,
            passed: 0,
            failed: 0,
            warnings: 0
        };

        // Helper functions
        function addTestResult(containerId, testName, status, message, details = '') {
            const container = document.getElementById(containerId);
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result test-${status}`;
            
            let icon = '';
            switch(status) {
                case 'success': icon = 'bi-check-circle'; break;
                case 'error': icon = 'bi-x-circle'; break;
                case 'warning': icon = 'bi-exclamation-triangle'; break;
            }
            
            resultDiv.innerHTML = `
                <div class="d-flex align-items-start">
                    <i class="bi ${icon} me-2 mt-1"></i>
                    <div class="flex-grow-1">
                        <strong>${testName}</strong>
                        <div>${message}</div>
                        ${details ? `<small class="text-muted">${details}</small>` : ''}
                    </div>
                </div>
            `;
            
            container.appendChild(resultDiv);
            
            // Update counters
            testResults.total++;
            if (status === 'success') testResults.passed++;
            else if (status === 'error') testResults.failed++;
            else if (status === 'warning') testResults.warnings++;
            
            updateSummary();
        }

        function updateSummary() {
            document.getElementById('totalTests').textContent = testResults.total;
            document.getElementById('passedTests').textContent = testResults.passed;
            document.getElementById('failedTests').textContent = testResults.failed;
            document.getElementById('warningTests').textContent = testResults.warnings;
        }

        function clearResults() {
            const containers = ['errorHandlerResults', 'coreFunctionResults', 'simpananFunctionResults', 'localStorageResults'];
            containers.forEach(id => {
                document.getElementById(id).innerHTML = '';
            });
            
            testResults = { total: 0, passed: 0, failed: 0, warnings: 0 };
            updateSummary();
        }

        // Error Handler Module Tests
        function testErrorLogging() {
            try {
                // Test basic error logging
                if (typeof logError === 'function') {
                    logError('test_context', 'Test error message', { testData: 'sample' });
                    addTestResult('errorHandlerResults', 'Error Logging', 'success', 'Error logging function works correctly');
                } else {
                    addTestResult('errorHandlerResults', 'Error Logging', 'error', 'logError function not found');
                }

                // Test error log retrieval
                if (typeof getErrorLog === 'function') {
                    const log = getErrorLog();
                    if (Array.isArray(log)) {
                        addTestResult('errorHandlerResults', 'Error Log Retrieval', 'success', `Retrieved ${log.length} error entries`);
                    } else {
                        addTestResult('errorHandlerResults', 'Error Log Retrieval', 'warning', 'Error log is not an array');
                    }
                } else {
                    addTestResult('errorHandlerResults', 'Error Log Retrieval', 'error', 'getErrorLog function not found');
                }
            } catch (error) {
                addTestResult('errorHandlerResults', 'Error Logging Test', 'error', `Test failed: ${error.message}`);
            }
        }

        function testUserFriendlyMessages() {
            try {
                if (typeof getUserFriendlyMessage === 'function') {
                    const message = getUserFriendlyMessage('anggota_not_found');
                    if (message && message.length > 0) {
                        addTestResult('errorHandlerResults', 'User-Friendly Messages', 'success', `Message: "${message}"`);
                    } else {
                        addTestResult('errorHandlerResults', 'User-Friendly Messages', 'warning', 'Empty message returned');
                    }
                } else {
                    addTestResult('errorHandlerResults', 'User-Friendly Messages', 'error', 'getUserFriendlyMessage function not found');
                }

                if (typeof showUserError === 'function') {
                    // Test without actually showing alert
                    addTestResult('errorHandlerResults', 'Show User Error', 'success', 'showUserError function available');
                } else {
                    addTestResult('errorHandlerResults', 'Show User Error', 'error', 'showUserError function not found');
                }
            } catch (error) {
                addTestResult('errorHandlerResults', 'User-Friendly Messages Test', 'error', `Test failed: ${error.message}`);
            }
        }

        function testInputValidation() {
            try {
                // Test anggota ID validation
                if (typeof validateAnggotaId === 'function') {
                    const validResult = validateAnggotaId('A001');
                    const invalidResult = validateAnggotaId('');
                    
                    if (validResult.valid && !invalidResult.valid) {
                        addTestResult('errorHandlerResults', 'Anggota ID Validation', 'success', 'Validation works correctly');
                    } else {
                        addTestResult('errorHandlerResults', 'Anggota ID Validation', 'warning', 'Validation logic may be incorrect');
                    }
                } else {
                    addTestResult('errorHandlerResults', 'Anggota ID Validation', 'error', 'validateAnggotaId function not found');
                }

                // Test amount validation
                if (typeof validateAmount === 'function') {
                    const validAmount = validateAmount(1000);
                    const invalidAmount = validateAmount(-100);
                    
                    if (validAmount.valid && !invalidAmount.valid) {
                        addTestResult('errorHandlerResults', 'Amount Validation', 'success', 'Amount validation works correctly');
                    } else {
                        addTestResult('errorHandlerResults', 'Amount Validation', 'warning', 'Amount validation logic may be incorrect');
                    }
                } else {
                    addTestResult('errorHandlerResults', 'Amount Validation', 'error', 'validateAmount function not found');
                }
            } catch (error) {
                addTestResult('errorHandlerResults', 'Input Validation Test', 'error', `Test failed: ${error.message}`);
            }
        }

        function testSafeDataAccess() {
            try {
                // Test safe localStorage get
                if (typeof safeGetLocalStorage === 'function') {
                    const data = safeGetLocalStorage('test_key', []);
                    if (Array.isArray(data)) {
                        addTestResult('errorHandlerResults', 'Safe LocalStorage Get', 'success', 'Safe get function works correctly');
                    } else {
                        addTestResult('errorHandlerResults', 'Safe LocalStorage Get', 'warning', 'Unexpected return type');
                    }
                } else {
                    addTestResult('errorHandlerResults', 'Safe LocalStorage Get', 'error', 'safeGetLocalStorage function not found');
                }

                // Test safe localStorage set
                if (typeof safeSetLocalStorage === 'function') {
                    const success = safeSetLocalStorage('test_key', { test: 'data' });
                    if (typeof success === 'boolean') {
                        addTestResult('errorHandlerResults', 'Safe LocalStorage Set', 'success', `Set operation ${success ? 'succeeded' : 'failed'}`);
                    } else {
                        addTestResult('errorHandlerResults', 'Safe LocalStorage Set', 'warning', 'Unexpected return type');
                    }
                } else {
                    addTestResult('errorHandlerResults', 'Safe LocalStorage Set', 'error', 'safeSetLocalStorage function not found');
                }

                // Test safe find anggota
                if (typeof safeFindAnggota === 'function') {
                    const result = safeFindAnggota('test_id');
                    if (result && typeof result.success === 'boolean') {
                        addTestResult('errorHandlerResults', 'Safe Find Anggota', 'success', `Find operation returned proper result structure`);
                    } else {
                        addTestResult('errorHandlerResults', 'Safe Find Anggota', 'warning', 'Unexpected result structure');
                    }
                } else {
                    addTestResult('errorHandlerResults', 'Safe Find Anggota', 'error', 'safeFindAnggota function not found');
                }
            } catch (error) {
                addTestResult('errorHandlerResults', 'Safe Data Access Test', 'error', `Test failed: ${error.message}`);
            }
        }

        // Core Function Error Handling Tests
        function testFilterActiveAnggotaErrors() {
            try {
                if (typeof filterActiveAnggota === 'function') {
                    // Test with valid array
                    const validResult = filterActiveAnggota([
                        { id: '1', statusKeanggotaan: 'Aktif' },
                        { id: '2', statusKeanggotaan: 'Keluar' }
                    ]);
                    
                    // Test with invalid input
                    const invalidResult = filterActiveAnggota(null);
                    const invalidResult2 = filterActiveAnggota('not an array');
                    
                    if (Array.isArray(validResult) && Array.isArray(invalidResult) && Array.isArray(invalidResult2)) {
                        addTestResult('coreFunctionResults', 'filterActiveAnggota Error Handling', 'success', 
                            `Valid: ${validResult.length} items, Invalid inputs handled gracefully`);
                    } else {
                        addTestResult('coreFunctionResults', 'filterActiveAnggota Error Handling', 'warning', 
                            'Function may not handle all error cases properly');
                    }
                } else {
                    addTestResult('coreFunctionResults', 'filterActiveAnggota Error Handling', 'error', 
                        'filterActiveAnggota function not found');
                }
            } catch (error) {
                addTestResult('coreFunctionResults', 'filterActiveAnggota Error Test', 'error', `Test failed: ${error.message}`);
            }
        }

        function testFilterTransactableAnggotaErrors() {
            try {
                if (typeof filterTransactableAnggota === 'function') {
                    // Test with valid array
                    const validResult = filterTransactableAnggota([
                        { id: '1', status: 'Aktif', statusKeanggotaan: 'Aktif' },
                        { id: '2', status: 'Nonaktif', statusKeanggotaan: 'Aktif' }
                    ]);
                    
                    // Test with invalid input
                    const invalidResult = filterTransactableAnggota(undefined);
                    
                    if (Array.isArray(validResult) && Array.isArray(invalidResult)) {
                        addTestResult('coreFunctionResults', 'filterTransactableAnggota Error Handling', 'success', 
                            `Valid: ${validResult.length} items, Invalid inputs handled gracefully`);
                    } else {
                        addTestResult('coreFunctionResults', 'filterTransactableAnggota Error Handling', 'warning', 
                            'Function may not handle all error cases properly');
                    }
                } else {
                    addTestResult('coreFunctionResults', 'filterTransactableAnggota Error Handling', 'error', 
                        'filterTransactableAnggota function not found');
                }
            } catch (error) {
                addTestResult('coreFunctionResults', 'filterTransactableAnggota Error Test', 'error', `Test failed: ${error.message}`);
            }
        }

        function testValidateAnggotaForTransactionErrors() {
            try {
                if (typeof validateAnggotaForTransaction === 'function') {
                    // Test with empty ID
                    const emptyResult = validateAnggotaForTransaction('');
                    const nullResult = validateAnggotaForTransaction(null);
                    
                    // Test with non-existent ID
                    const nonExistentResult = validateAnggotaForTransaction('non-existent-id');
                    
                    if (!emptyResult.valid && !nullResult.valid && !nonExistentResult.valid) {
                        addTestResult('coreFunctionResults', 'validateAnggotaForTransaction Error Handling', 'success', 
                            'All invalid inputs properly rejected');
                    } else {
                        addTestResult('coreFunctionResults', 'validateAnggotaForTransaction Error Handling', 'warning', 
                            'Some invalid inputs may not be properly handled');
                    }
                } else {
                    addTestResult('coreFunctionResults', 'validateAnggotaForTransaction Error Handling', 'error', 
                        'validateAnggotaForTransaction function not found');
                }
            } catch (error) {
                addTestResult('coreFunctionResults', 'validateAnggotaForTransaction Error Test', 'error', `Test failed: ${error.message}`);
            }
        }

        // Simpanan Function Error Handling Tests
        function testSaveSimpananPokokErrors() {
            try {
                // Create mock DOM elements for testing
                const mockContainer = document.createElement('div');
                mockContainer.innerHTML = `
                    <select id="anggotaPokok"><option value="">Select</option></select>
                    <input id="jumlahPokok" value="">
                    <input id="tanggalPokok" value="">
                `;
                document.body.appendChild(mockContainer);
                
                if (typeof saveSimpananPokok === 'function') {
                    // This would normally show alerts, so we just test that it doesn't crash
                    try {
                        saveSimpananPokok();
                        addTestResult('simpananFunctionResults', 'saveSimpananPokok Error Handling', 'success', 
                            'Function executed without crashing on empty inputs');
                    } catch (funcError) {
                        addTestResult('simpananFunctionResults', 'saveSimpananPokok Error Handling', 'warning', 
                            `Function threw error: ${funcError.message}`);
                    }
                } else {
                    addTestResult('simpananFunctionResults', 'saveSimpananPokok Error Handling', 'error', 
                        'saveSimpananPokok function not found');
                }
                
                // Clean up
                document.body.removeChild(mockContainer);
            } catch (error) {
                addTestResult('simpananFunctionResults', 'saveSimpananPokok Error Test', 'error', `Test failed: ${error.message}`);
            }
        }

        function testZeroingSimpananErrors() {
            try {
                if (typeof zeroSimpananPokok === 'function') {
                    // Test with invalid ID
                    const result = zeroSimpananPokok('');
                    if (result && typeof result.success === 'boolean') {
                        addTestResult('simpananFunctionResults', 'Zeroing Functions Error Handling', 'success', 
                            `Zeroing function returned proper result structure`);
                    } else {
                        addTestResult('simpananFunctionResults', 'Zeroing Functions Error Handling', 'warning', 
                            'Unexpected result structure from zeroing function');
                    }
                } else {
                    addTestResult('simpananFunctionResults', 'Zeroing Functions Error Handling', 'error', 
                        'zeroSimpananPokok function not found');
                }
            } catch (error) {
                addTestResult('simpananFunctionResults', 'Zeroing Functions Error Test', 'error', `Test failed: ${error.message}`);
            }
        }

        function testJournalCreationErrors() {
            try {
                if (typeof createPencairanJournal === 'function') {
                    // Test with invalid inputs
                    const result = createPencairanJournal('', 'Invalid Type', -100);
                    if (result && typeof result.success === 'boolean' && !result.success) {
                        addTestResult('simpananFunctionResults', 'Journal Creation Error Handling', 'success', 
                            'Journal creation properly rejects invalid inputs');
                    } else {
                        addTestResult('simpananFunctionResults', 'Journal Creation Error Handling', 'warning', 
                            'Journal creation may not properly validate inputs');
                    }
                } else {
                    addTestResult('simpananFunctionResults', 'Journal Creation Error Handling', 'error', 
                        'createPencairanJournal function not found');
                }
            } catch (error) {
                addTestResult('simpananFunctionResults', 'Journal Creation Error Test', 'error', `Test failed: ${error.message}`);
            }
        }

        // LocalStorage Health Check Tests
        function testLocalStorageHealth() {
            try {
                if (typeof checkLocalStorageHealth === 'function') {
                    const health = checkLocalStorageHealth();
                    if (health && typeof health.healthy === 'boolean') {
                        const status = health.healthy ? 'success' : 'warning';
                        const message = health.healthy ? 
                            'LocalStorage is healthy' : 
                            `Health issues found: ${health.issues.length} issues, ${health.repairs.length} repairs`;
                        addTestResult('localStorageResults', 'LocalStorage Health Check', status, message);
                    } else {
                        addTestResult('localStorageResults', 'LocalStorage Health Check', 'error', 
                            'Health check returned unexpected result');
                    }
                } else {
                    addTestResult('localStorageResults', 'LocalStorage Health Check', 'error', 
                        'checkLocalStorageHealth function not found');
                }
            } catch (error) {
                addTestResult('localStorageResults', 'LocalStorage Health Test', 'error', `Test failed: ${error.message}`);
            }
        }

        function simulateCorruptedData() {
            try {
                // Simulate corrupted data
                localStorage.setItem('test_corrupted', 'invalid json {');
                addTestResult('localStorageResults', 'Simulate Corrupted Data', 'warning', 
                    'Corrupted data simulated in localStorage');
            } catch (error) {
                addTestResult('localStorageResults', 'Simulate Corrupted Data', 'error', `Failed: ${error.message}`);
            }
        }

        function testDataRecovery() {
            try {
                if (typeof recoverLocalStorageData === 'function') {
                    const recovered = recoverLocalStorageData('test_corrupted', []);
                    if (Array.isArray(recovered)) {
                        addTestResult('localStorageResults', 'Data Recovery', 'success', 
                            'Data recovery function works correctly');
                    } else {
                        addTestResult('localStorageResults', 'Data Recovery', 'warning', 
                            'Recovery function returned unexpected type');
                    }
                } else {
                    addTestResult('localStorageResults', 'Data Recovery', 'error', 
                        'recoverLocalStorageData function not found');
                }
            } catch (error) {
                addTestResult('localStorageResults', 'Data Recovery Test', 'error', `Test failed: ${error.message}`);
            }
        }

        // Error Log Management
        function viewErrorLog() {
            try {
                if (typeof getErrorLog === 'function') {
                    const log = getErrorLog();
                    const display = document.getElementById('errorLogDisplay');
                    
                    if (Array.isArray(log) && log.length > 0) {
                        display.innerHTML = log.map(entry => 
                            `<div class="mb-2">
                                <strong>${entry.timestamp}</strong> - ${entry.context}<br>
                                <span class="text-danger">${entry.error.message || entry.error}</span>
                            </div>`
                        ).join('');
                    } else {
                        display.innerHTML = 'No error log entries found';
                    }
                } else {
                    document.getElementById('errorLogDisplay').innerHTML = 'getErrorLog function not available';
                }
            } catch (error) {
                document.getElementById('errorLogDisplay').innerHTML = `Error viewing log: ${error.message}`;
            }
        }

        function clearErrorLog() {
            try {
                if (typeof clearErrorLog === 'function') {
                    clearErrorLog();
                    document.getElementById('errorLogDisplay').innerHTML = 'Error log cleared';
                } else {
                    document.getElementById('errorLogDisplay').innerHTML = 'clearErrorLog function not available';
                }
            } catch (error) {
                document.getElementById('errorLogDisplay').innerHTML = `Error clearing log: ${error.message}`;
            }
        }

        // Run all tests
        function runAllTests() {
            clearResults();
            
            // Error Handler Module Tests
            testErrorLogging();
            testUserFriendlyMessages();
            testInputValidation();
            testSafeDataAccess();
            
            // Core Function Tests
            testFilterActiveAnggotaErrors();
            testFilterTransactableAnggotaErrors();
            testValidateAnggotaForTransactionErrors();
            
            // Simpanan Function Tests
            testSaveSimpananPokokErrors();
            testZeroingSimpananErrors();
            testJournalCreationErrors();
            
            // LocalStorage Tests
            testLocalStorageHealth();
            simulateCorruptedData();
            testDataRecovery();
            
            // View error log
            viewErrorLog();
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Task 21: Comprehensive Error Handling Test Page Loaded');
            updateSummary();
        });
    </script>
</body>
</html>