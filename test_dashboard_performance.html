<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Performance Test</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .test-result { padding: 12px; border-radius: 8px; margin: 8px 0; font-family: monospace; }
        .test-success { background-color: #dcfce7; border: 1px solid #16a34a; color: #15803d; }
        .test-error { background-color: #fef2f2; border: 1px solid #dc2626; color: #dc2626; }
        .performance-metric { font-size: 1.2rem; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container mt-4">
        <h1>Dashboard Performance Test</h1>
        <button class="btn btn-primary" onclick="runPerformanceTest()">Run Performance Test</button>
        <div id="results" class="mt-4"></div>
    </div>

    <script src="js/dashboard/types.js"></script>
    <script src="js/dashboard/DashboardController.js"></script>
    <script>
        async function runPerformanceTest() {
            const results = document.getElementById('results');
            results.innerHTML = '<div class="spinner-border" role="status"></div> Running tests...';
            
            const testResults = [];
            
            // Test 1: Dashboard Loading Performance
            try {
                const startTime = performance.now();
                const dashboard = new DashboardController('test-container');
                await dashboard.initialize();
                await dashboard.loadDashboard('test-user', 'manager');
                const endTime = performance.now();
                const loadTime = endTime - startTime;
                
                testResults.push({
                    name: 'Dashboard Loading Performance',
                    success: loadTime < 3000,
                    time: loadTime,
                    requirement: '< 3000ms'
                });
                
                dashboard.destroy();
            } catch (error) {
                testResults.push({
                    name: 'Dashboard Loading Performance',
                    success: false,
                    error: error.message
                });
            }
            
            displayResults(testResults);
        }
        
        function displayResults(results) {
            const container = document.getElementById('results');
            let html = '<h3>Performance Test Results</h3>';
            
            results.forEach(result => {
                const cssClass = result.success ? 'test-success' : 'test-error';
                html += `<div class="${cssClass}">`;
                html += `<strong>${result.name}</strong><br>`;
                if (result.time) {
                    html += `<span class="performance-metric">${result.time.toFixed(2)}ms</span> `;
                    html += `(Requirement: ${result.requirement})<br>`;
                }
                html += `Status: ${result.success ? 'PASS' : 'FAIL'}`;
                if (result.error) html += `<br>Error: ${result.error}`;
                html += '</div>';
            });
            
            container.innerHTML = html;
        }
    </script>
</body>
</html>