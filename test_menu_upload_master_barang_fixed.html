<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Menu Upload Master Barang - Fixed</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <div class="row">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header bg-success text-white">
                        <h5><i class="bi bi-check-circle me-2"></i>Menu Super Admin</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <button class="btn btn-primary" onclick="testSuperAdmin()">Test Super Admin Menu</button>
                        </div>
                        <ul id="superAdminMenu" class="list-group"></ul>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header bg-info text-white">
                        <h5><i class="bi bi-check-circle me-2"></i>Menu Administrator</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <button class="btn btn-primary" onclick="testAdministrator()">Test Administrator Menu</button>
                        </div>
                        <ul id="administratorMenu" class="list-group"></ul>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5>Test Results</h5>
                    </div>
                    <div class="card-body">
                        <div id="testResults"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Mock current user
        window.currentUser = { role: 'super_admin', username: 'admin' };
        
        // Mock navigateTo function
        function navigateTo(page) {
            console.log('Navigate to:', page);
            if (page === 'upload-master-barang-excel') {
                alert('✅ Menu Upload Master Barang Excel berhasil diklik!');
            }
        }

        function testSuperAdmin() {
            window.currentUser.role = 'super_admin';
            const menuContainer = document.getElementById('superAdminMenu');
            
            const menus = [
                { icon: 'bi-speedometer2', text: 'Dashboard', page: 'dashboard' },
                { icon: 'bi-gear-fill', text: 'Pengaturan Sistem', page: 'system-settings' },
                { icon: 'bi-shield-lock', text: 'Audit Log', page: 'audit-log' },
                { icon: 'bi-building', text: 'Data Koperasi', page: 'koperasi' },
                { icon: 'bi-people', text: 'Master Anggota', page: 'anggota' },
                { icon: 'bi-diagram-3', text: 'Master Departemen', page: 'departemen' },
                { icon: 'bi-credit-card-2-front', text: 'Aktivasi Kartu', page: 'aktivasi-kartu' },
                { icon: 'bi-wallet2', text: 'Simpanan', page: 'simpanan' },
                { icon: 'bi-cash-coin', text: 'Pinjaman', page: 'pinjaman' },
                { icon: 'bi-box-arrow-right', text: 'Anggota Keluar', page: 'anggota-keluar' },
                { icon: 'bi-calendar-check', text: 'Saldo Awal Periode', page: 'saldo-awal' },
                { icon: 'bi-journal-text', text: 'Chart of Account', page: 'coa' },
                { icon: 'bi-book', text: 'Jurnal', page: 'jurnal' },
                { icon: 'bi-calculator', text: 'SHU', page: 'shu' },
                { icon: 'bi-currency-exchange', text: 'Pembayaran Hutang/Piutang', page: 'pembayaran-hutang-piutang' },
                { icon: 'bi-cart', text: 'Point of Sales', page: 'pos' },
                { icon: 'bi-clipboard-check', text: 'Kelola Pengajuan Modal', page: 'kelola-pengajuan-modal' },
                { icon: 'bi-clock-history', text: 'Riwayat Pengajuan Modal', page: 'riwayat-pengajuan-admin' },
                { icon: 'bi-box-seam', text: 'Master Barang', page: 'barang' },
                { icon: 'bi-file-excel', text: 'Upload Master Barang Excel', page: 'upload-master-barang-excel' },
                { icon: 'bi-truck', text: 'Supplier', page: 'supplier' },
                { icon: 'bi-bag-plus', text: 'Pembelian', page: 'pembelian' },
                { icon: 'bi-clipboard-data', text: 'Stok Opname', page: 'stokopname' },
                { icon: 'bi-trash', text: 'Hapus Transaksi', page: 'hapus-transaksi' },
                { icon: 'bi-clock-history', text: 'Riwayat Hapus Transaksi', page: 'riwayat-hapus-transaksi' },
                { icon: 'bi-clock-history', text: 'Riwayat Tutup Kasir', page: 'riwayat-tutup-kas' },
                { icon: 'bi-database', text: 'Backup & Restore', page: 'backup-restore' },
                { icon: 'bi-file-earmark-text', text: 'Laporan', page: 'laporan' },
                { icon: 'bi-file-earmark-bar-graph', text: 'Laporan Transaksi & Simpanan', page: 'laporan-transaksi-simpanan' },
                { icon: 'bi-person-gear', text: 'Manajemen User', page: 'users' },
                { icon: 'bi-info-circle', text: 'Tentang Aplikasi', page: 'tentang' }
            ];
            
            menuContainer.innerHTML = menus.map(menu => {
                const isUploadMenu = menu.page === 'upload-master-barang-excel';
                const badgeClass = isUploadMenu ? 'bg-success' : 'bg-secondary';
                const badge = isUploadMenu ? '<span class="badge bg-success ms-2">NEW</span>' : '';
                
                return `
                    <li class="list-group-item d-flex justify-content-between align-items-center ${isUploadMenu ? 'border-success' : ''}">
                        <a href="#" class="text-decoration-none ${isUploadMenu ? 'text-success fw-bold' : ''}" 
                           onclick="navigateTo('${menu.page}'); return false;">
                            <i class="${menu.icon} me-2"></i>${menu.text}
                        </a>
                        ${badge}
                    </li>
                `;
            }).join('');
            
            // Update test results
            updateTestResults('super_admin', menus);
        }

        function testAdministrator() {
            window.currentUser.role = 'administrator';
            const menuContainer = document.getElementById('administratorMenu');
            
            const menus = [
                { icon: 'bi-speedometer2', text: 'Dashboard', page: 'dashboard' },
                { icon: 'bi-building', text: 'Data Koperasi', page: 'koperasi' },
                { icon: 'bi-people', text: 'Master Anggota', page: 'anggota' },
                { icon: 'bi-diagram-3', text: 'Master Departemen', page: 'departemen' },
                { icon: 'bi-credit-card-2-front', text: 'Aktivasi Kartu', page: 'aktivasi-kartu' },
                { icon: 'bi-wallet2', text: 'Simpanan', page: 'simpanan' },
                { icon: 'bi-cash-coin', text: 'Pinjaman', page: 'pinjaman' },
                { icon: 'bi-box-arrow-right', text: 'Anggota Keluar', page: 'anggota-keluar' },
                { icon: 'bi-calendar-check', text: 'Saldo Awal Periode', page: 'saldo-awal' },
                { icon: 'bi-journal-text', text: 'Chart of Account', page: 'coa' },
                { icon: 'bi-book', text: 'Jurnal', page: 'jurnal' },
                { icon: 'bi-calculator', text: 'SHU', page: 'shu' },
                { icon: 'bi-currency-exchange', text: 'Pembayaran Hutang/Piutang', page: 'pembayaran-hutang-piutang' },
                { icon: 'bi-cart', text: 'Point of Sales', page: 'pos' },
                { icon: 'bi-clipboard-check', text: 'Kelola Pengajuan Modal', page: 'kelola-pengajuan-modal' },
                { icon: 'bi-clock-history', text: 'Riwayat Pengajuan Modal', page: 'riwayat-pengajuan-admin' },
                { icon: 'bi-box-seam', text: 'Master Barang', page: 'barang' },
                { icon: 'bi-file-excel', text: 'Upload Master Barang Excel', page: 'upload-master-barang-excel' },
                { icon: 'bi-truck', text: 'Supplier', page: 'supplier' },
                { icon: 'bi-bag-plus', text: 'Pembelian', page: 'pembelian' },
                { icon: 'bi-clipboard-data', text: 'Stok Opname', page: 'stokopname' },
                { icon: 'bi-trash', text: 'Hapus Transaksi', page: 'hapus-transaksi' },
                { icon: 'bi-clock-history', text: 'Riwayat Hapus Transaksi', page: 'riwayat-hapus-transaksi' },
                { icon: 'bi-clock-history', text: 'Riwayat Tutup Kasir', page: 'riwayat-tutup-kas' },
                { icon: 'bi-database', text: 'Backup & Restore', page: 'backup-restore' },
                { icon: 'bi-file-earmark-text', text: 'Laporan', page: 'laporan' },
                { icon: 'bi-file-earmark-bar-graph', text: 'Laporan Transaksi & Simpanan', page: 'laporan-transaksi-simpanan' },
                { icon: 'bi-person-gear', text: 'Manajemen User', page: 'users' },
                { icon: 'bi-info-circle', text: 'Tentang Aplikasi', page: 'tentang' }
            ];
            
            menuContainer.innerHTML = menus.map(menu => {
                const isUploadMenu = menu.page === 'upload-master-barang-excel';
                const badgeClass = isUploadMenu ? 'bg-success' : 'bg-secondary';
                const badge = isUploadMenu ? '<span class="badge bg-success ms-2">NEW</span>' : '';
                
                return `
                    <li class="list-group-item d-flex justify-content-between align-items-center ${isUploadMenu ? 'border-success' : ''}">
                        <a href="#" class="text-decoration-none ${isUploadMenu ? 'text-success fw-bold' : ''}" 
                           onclick="navigateTo('${menu.page}'); return false;">
                            <i class="${menu.icon} me-2"></i>${menu.text}
                        </a>
                        ${badge}
                    </li>
                `;
            }).join('');
            
            // Update test results
            updateTestResults('administrator', menus);
        }

        function updateTestResults(role, menus) {
            const uploadMenu = menus.find(menu => menu.page === 'upload-master-barang-excel');
            const resultsContainer = document.getElementById('testResults');
            
            if (uploadMenu) {
                resultsContainer.innerHTML = `
                    <div class="alert alert-success">
                        <h6><i class="bi bi-check-circle-fill me-2"></i>Test Berhasil untuk Role: ${role}</h6>
                        <p class="mb-0">✅ Menu "Upload Master Barang Excel" ditemukan di posisi ${menus.indexOf(uploadMenu) + 1} dari ${menus.length} menu</p>
                        <p class="mb-0">✅ Icon: ${uploadMenu.icon}</p>
                        <p class="mb-0">✅ Page: ${uploadMenu.page}</p>
                    </div>
                `;
            } else {
                resultsContainer.innerHTML = `
                    <div class="alert alert-danger">
                        <h6><i class="bi bi-x-circle-fill me-2"></i>Test Gagal untuk Role: ${role}</h6>
                        <p class="mb-0">❌ Menu "Upload Master Barang Excel" TIDAK ditemukan</p>
                    </div>
                `;
            }
        }

        // Auto-run tests when page loads
        document.addEventListener('DOMContentLoaded', function() {
            testSuperAdmin();
        });
    </script>
</body>
</html>